<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebApp Météo avec VueJs</title>

  <!-- Bootstrap CSS -->
  <link href="css/bootstrap.css" rel="stylesheet">
  <!-- Weather Icons -->
  <link rel="stylesheet" href="css/weather-icons.min.css">
</head>
<body class="bg-light">

<div id="weatherApp" class="container mt-5">

  <h1 class="text-center mb-4 display-4">WebApp Météo avec VueJs</h1>

  <!-- Formulaire d'ajout de ville -->
  <form @submit.prevent="addCity" class="mb-4">
    <div class="input-group input-group-lg">
      <input type="search" class="form-control" v-model="formCityName"
             placeholder="Paris, Tokyo, New York..." required autofocus>
      <button class="btn btn-primary" type="submit">Go!</button>
    </div>
    <small class="text-muted d-block mt-2">{{ formCityName.length }} car.</small>
    <div class="alert alert-danger mt-2" v-if="messageForm">{{ messageForm }}</div>
  </form>

  <!-- Bonus : Bouton Ma position -->
  <div class="text-center mb-4">
    <button @click="getMyPosition" class="btn btn-success btn-lg">
      Ma position actuelle
    </button>
  </div>

  <!-- Liste des villes -->
  <h4 class="mb-3">Liste des villes ({{ cityList.length }})</h4>
  <ul class="list-group mb-5">
    <a href="#" v-for="city in cityList" @click.prevent="meteo(city)"
       class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
      {{ city.name }}
      <button @click.prevent.stop="remove(city)" class="btn btn-danger btn-sm">×</button>
    </a>
  </ul>

  <!-- Chargement -->
  <div v-if="cityWeatherLoading" class="text-center my-5">
    <div class="spinner-border text-primary" style="width:3rem;height:3rem;"></div>
    <p class="mt-3">Chargement de la météo...</p>
  </div>

  <!-- Carte météo -->
  <div v-if="cityWeather" class="card mx-auto shadow-lg" style="max-width: 420px;">
    <div class="card-header text-center bg-primary text-white">
      <strong class="fs-4">{{ cityWeather.name }}</strong> @{{ cityWheaterDate }}
    </div>

    <!-- OpenStreetMap -->
    <iframe width="100%" height="220" frameborder="0"
            :src="'https://www.openstreetmap.org/export/embed.html?bbox='+openStreetMapArea+'&layer=mapnik&marker='+cityWeather.coord.lat+'%2C'+cityWeather.coord.lon">
    </iframe>

    <div class="card-body text-center">
      <h2 class="display-3">
        <i :class="'wi wi-owm-' + cityWeather.weather[0].id"></i>
        {{ Math.round(cityWeather.main.temp) }}°C
      </h2>
      <p class="text-capitalize fs-4">{{ cityWeather.weather[0].description }}</p>
    </div>

    <ul class="list-group list-group-flush">
      <li class="list-group-item"><i class="wi wi-cloud"></i> Nuage : {{ cityWeather.clouds.all }} %</li>
      <li class="list-group-item"><i class="wi wi-humidity"></i> Humidité : {{ cityWeather.main.humidity }} %</li>
      <li class="list-group-item"><i class="wi wi-windy"></i> Vent : {{ cityWeather.wind.speed }} km/h</li>
      <li class="list-group-item"><i class="wi wi-sunrise"></i> Lever du soleil : {{ cityWheaterSunrise }}</li>
      <li class="list-group-item"><i class="wi wi-sunset"></i> Coucher du soleil : {{ cityWheaterSunset }}</li>
    </ul>
  </div>

</div>

<!-- Scripts -->
<script src="js/libs/vue.js"></script>
<script src="js/libs/bootstrap.bundle.js"></script>
<script src="js/main.js"></script>
</body>
</html>
